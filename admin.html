<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>GGK Admin Dashboard</title>
    <link rel="icon" type="image/jpeg" href="assets/website-icon.jpg" />
    <link rel="stylesheet" href="admin.css" />
  </head>
  <body>
    <main class="admin-page">
      <header class="admin-header">
        <div>
          <p class="eyebrow">GGK Internal</p>
          <h1>Admin Dashboard</h1>
          <p>Order monitoring and profitability tracking.</p>
        </div>
        <div class="auth-actions">
          <span id="authStateLabel" class="auth-state">Not signed in</span>
          <button id="refreshButton" class="pill-button" type="button" disabled>Refresh</button>
          <button id="signOutButton" class="pill-button" type="button" hidden>Sign Out</button>
        </div>
      </header>

      <section class="panel" id="authPanel">
        <h2>Admin Sign In</h2>
        <p class="panel-note">Use your GGK admin account. Access is controlled by Supabase RLS.</p>
        <form id="authForm" class="auth-form">
          <label>
            Email
            <input id="authEmail" type="email" required />
          </label>
          <label>
            Password
            <input id="authPassword" type="password" required />
          </label>
          <button class="pill-button" type="submit">Sign In</button>
          <p id="authMessage" class="panel-note"></p>
        </form>
      </section>

      <section class="stats-grid" id="statsGrid">
        <article class="stat-card">
          <span>Orders</span>
          <strong id="ordersCount">0</strong>
        </article>
        <article class="stat-card">
          <span>Items</span>
          <strong id="itemsCount">0</strong>
        </article>
        <article class="stat-card">
          <span>Revenue</span>
          <strong id="revenueTotal">PHP 0.00</strong>
        </article>
        <article class="stat-card">
          <span>Cost</span>
          <strong id="costTotal">PHP 0.00</strong>
        </article>
        <article class="stat-card">
          <span>Profit</span>
          <strong id="profitTotal">PHP 0.00</strong>
        </article>
      </section>

      <section class="panel">
        <h2>Filters</h2>
        <p class="panel-note">Filters are stackable. You can apply multiple groups at the same time.</p>
        <div class="filters-grid">
          <div class="filter-group">
            <h3>Payment</h3>
            <div id="paymentFilters" class="chip-list"></div>
          </div>
          <div class="filter-group">
            <h3>Fulfillment</h3>
            <div id="deliveryFilters" class="chip-list"></div>
          </div>
          <div class="filter-group">
            <h3>Size</h3>
            <div id="sizeFilters" class="chip-list"></div>
          </div>
          <div class="filter-group">
            <h3>Product</h3>
            <div id="productFilters" class="chip-list"></div>
          </div>
          <div class="filter-group">
            <h3>Shirt Color</h3>
            <div id="colorFilters" class="chip-list"></div>
          </div>
          <div class="filter-group">
            <h3>Sort</h3>
            <select id="sortSelect">
              <option value="newest">Newest First</option>
              <option value="oldest">Oldest First</option>
              <option value="revenue_desc">Revenue High to Low</option>
              <option value="revenue_asc">Revenue Low to High</option>
              <option value="quantity_desc">Qty High to Low</option>
            </select>
          </div>
        </div>
      </section>

      <section class="panel">
        <h2>Cost Controls</h2>
        <p class="panel-note">
          Default shirt cost is <strong>PHP 300</strong>. Edit per design/color/size below.
        </p>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Product</th>
                <th>Color</th>
                <th>Size</th>
                <th>Type</th>
                <th>Unit Cost (PHP)</th>
              </tr>
            </thead>
            <tbody id="costTableBody"></tbody>
          </table>
        </div>
      </section>

      <section class="panel">
        <h2>Orders</h2>
        <p class="panel-note" id="statusMessage">Loading data...</p>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Order ID</th>
                <th>Customer</th>
                <th>Payment</th>
                <th>Fulfillment</th>
                <th>Product</th>
                <th>Color</th>
                <th>Size</th>
                <th>Type</th>
                <th>Qty</th>
                <th>Revenue</th>
                <th>Cost</th>
                <th>Profit</th>
              </tr>
            </thead>
            <tbody id="ordersTableBody"></tbody>
          </table>
        </div>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase.config.js"></script>
    <script src="admin.js"></script>
  </body>
</html>
